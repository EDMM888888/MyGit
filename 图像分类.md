[TOC]

# 图像分类网络模型框架解读

![image-20210623205201946](D:\Downloads\文档\pytorch\图像分类\图像分类.assets\image-20210623205201946.png)

# 数据加载模块      C，H  ，W

```python
torchvision.datasets中的数据集
torch.utils.data下的Dataset,DataLoader自定义数据集
```

opencv 拿到的数据是  BGR

# 数据增强

在神经网络中参数量是巨大的，而样本数是有限的，为了防止训练模型时因为样本不足而导致过拟合，同时可以为模型提供了一些原始训练集中不存在的一些情况，提高泛化能力。因此通过数据增强手段，使样本量增加，可以在一定程度上防止过拟合，增强泛化能力。

```python
train_transforms = transforms.Compose([
    ...
])
```

# 网络结构

 ![image-20210623192853290](D:\Downloads\文档\pytorch\图像分类\图像分类.assets\image-20210623192853290.png)

# 类别概率分布

N维向量对应N个类别

### 如何将卷积输出的tensor转换为N维向量？

1. 全连接层：需要定义输入维度和输出维度，无法适应输入尺寸的变化
2. 1X1卷积： 无法适应输入尺寸的变化
3. Pooling：由于无参数，故可以适应输入尺寸的变化

因此说，如果想让最终输出对输入图片的尺寸不敏感，可以采用pooling方式。

### 将N维向量转换为N个概率的方式：

#### Softmax

# 损失函数： 分类问题 交叉熵损失  

#### nn.CrossEntropyLoss

调优小技巧：使用软标签[0.95, 0.05, 0.05, ...]，可以避免计算损失时过于绝对而产生的硬预测。

## 分类任务评价模型指标

### 混淆矩阵：

![image-20210623200500057](D:\Downloads\文档\pytorch\图像分类\图像分类.assets\image-20210623200500057.png)

#### PR曲线、AP面积：（比较多）

横坐标：召回率 

纵坐标：精度

目标：高召回高精度

#### ROC曲线、AUC面积：

横坐标：FPR = FP / ( FP + TN )

纵坐标：TPR = TP / ( TP + FN )

目标：曲线中部越接近左上角

#### 如何绘制出曲线？

需要定义不同的阈值

# 优化器选择：

#### 推荐使用：torch.optim.Adam

学习率初始值：lr = 1e-3

#### 学习率指数衰减：torch.optim.lr_scheduler.ExponentialLR

